@model MIEL.web.Models.ViewModels.CategoryMasterVM
@{
    ViewData["Title"] = "Banner insert";
    Layout = "_AdminLayout";
}

<h2>Product Master</h2>

<label><b>Category</b></label>
<select id="ddlCategory" class="form-control">
    <option value="">-- Select Category --</option>

    @foreach (var cat in Model.Categories)
    {
        <option value="@cat.CategoryId">@cat.CategoryName</option>
    }
</select>

<br />

<h4>Specifications</h4>

<div class="card" style="border:1px solid #ddd; padding:15px; border-radius:8px;">
    <div class="card-header" style="background:#f5f5f5; padding:8px;">
        <b>Selected Category Specifications</b>
    </div>

    <div class="card-body" id="specContainer" style="margin-top:10px;">
        <p class="text-muted">Select a category to load specifications.</p>
    </div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        $("#ddlCategory").change(function () {

            var catId = $(this).val();

            if (catId == "") {
                $("#specContainer").html(
                  "<p class='text-muted'>Select a category to load specifications.</p>"
                );
                return;
            }

            $.ajax({
                url: "/ProductMaster/GetSpecifications",
                type: "POST",
                data: { categoryId: catId },
                success: function (data) {

                    $("#specContainer").empty();

                    if (data.length == 0) {
                        $("#specContainer").html(
                          "<p class='text-danger'>No specifications found.</p>"
                        );
                        return;
                    }

                    $.each(data, function (i, item) {

                        var html = "<div class='mb-3'>";

                        html += "<label><b>" + item.specName + "</b></label><br>";

                        // Textbox case
                        if (item.optionType == "Textbox") {
                            html += "<input type='text' class='form-control' />";
                        }

                        // Checkbox case
                        else if (item.optionType == "Checkbox") {

                            if (item.options) {
                                var opts = item.options.split(",");

                                for (var j = 0; j < opts.length; j++) {
                                    html += "<input type='checkbox' value='" + opts[j] + "' /> "
                                         + opts[j] + " &nbsp;&nbsp;";
                                }
                            }
                        }

                        html += "</div>";

                        $("#specContainer").append(html);
                    });
                }
            });
        });
    </script>
}
